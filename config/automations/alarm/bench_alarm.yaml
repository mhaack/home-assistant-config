---
# Garden bench movement notification. The bench should not be moved,
# especially not in the night or if we are not at home.
#
alias: "[Security] Bench movement alarm"
trigger:
  - platform: state
    entity_id: binary_sensor.gartenbank
    to: "on"
condition:
  - condition: or
    conditions:
      - condition: state
        entity_id: input_boolean.send_notification
        state: "on"
      - condition: state
        entity_id: input_boolean.bench_notification
        state: "on"
action:
  - service: notify.jama_group
    data:
      title: "JaMa Villa"
      message: "Bank hat sich bewegt - was ist hier los?"
      data:
        push:
          thread-id: "ha-carport-alarm-notification-group"
          category: "bench_alarm"      
  - service: camera.aarlo_request_snapshot
    data:
      entity_id: camera.aarlo_carport
  - service: switch.turn_on
    data:
      entity_id: switch.sirene_carport_3
  - delay: '00:03:00'
  - service: switch.turn_off
    data:
      entity_id: switch.sirene_carport_3
